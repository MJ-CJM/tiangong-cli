# Agents ç³»ç»Ÿæ–‡æ¡£

> **Gemini CLI - Agents åŠŸèƒ½å®Œæ•´æ–‡æ¡£**

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

### ç”¨æˆ·æ–‡æ¡£

1. **[ç”¨æˆ·æŒ‡å—](../../docs/AGENTS.md)** â­ - å®Œæ•´çš„ç”¨æˆ·ä½¿ç”¨æŒ‡å—
2. **[å¿«é€Ÿå¼€å§‹](./QUICK_START.md)** - 5 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
3. **[å‘½ä»¤å‚è€ƒ](./COMMANDS.md)** - æ‰€æœ‰ agent å‘½ä»¤è¯¦è§£
4. **[å·²å®ç°åŠŸèƒ½](./FEATURES_IMPLEMENTED.md)** ğŸ“– - å½“å‰æ‰€æœ‰åŠŸèƒ½çš„è¯¦ç»†è¯´æ˜

### è®¾è®¡ä¸å®ç°æ–‡æ¡£

5. **[ç³»ç»Ÿè®¾è®¡](./DESIGN.md)** - æ¶æ„è®¾è®¡å’Œæ ¸å¿ƒæ¦‚å¿µ
6. **[å®ç°ç»†èŠ‚](./IMPLEMENTATION_DETAILS.md)** - æŠ€æœ¯å®ç°ç»†èŠ‚
7. **[P1 å®Œæˆæ€»ç»“](./P1_COMPLETION_SUMMARY.md)** - P1 é˜¶æ®µå®ç°æ€»ç»“
8. **[P2 åŠŸèƒ½è§„åˆ’](./P2_FEATURES.md)** - æœªæ¥åŠŸèƒ½è§„åˆ’

### å†å²æ–‡æ¡£

9. **[åˆå§‹è®¾è®¡](./INITIAL_DESIGN.md)** - æ—©æœŸç³»ç»Ÿè®¾è®¡ï¼ˆå‚è€ƒï¼‰
10. **[å®æ–½è·¯çº¿å›¾](./ROADMAP.md)** - å®æ–½è®¡åˆ’ï¼ˆå‚è€ƒï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»º Agent

```bash
# äº¤äº’å¼åˆ›å»º
/agents create code_review --title "Code Reviewer" --model gemini-2.5-pro

# ç¼–è¾‘ç”Ÿæˆçš„æ–‡ä»¶
vim .gemini/agents/code_review.md
```

### 2. è¿è¡Œ Agent

**æ–¹å¼ä¸€ï¼šæ–œæ å‘½ä»¤**
```bash
/agents run code_review åˆ†æ src/index.ts çš„ä»£ç è´¨é‡
```

**æ–¹å¼äºŒï¼šè‡ªç„¶è¯­è¨€ï¼ˆæ¨èï¼‰**
```bash
ä½¿ç”¨ code_review agent åˆ†æ src/index.ts çš„ä»£ç è´¨é‡
@code_review å®¡æŸ¥è¿™æ®µä»£ç 
ç”¨ code_review agent æ£€æŸ¥ä»£ç é£æ ¼
```

### 3. è¿ç»­å¯¹è¯

```bash
> ä½¿ç”¨ code_review agent åˆ†æ /path/to/file.py
Agent: [è¯¦ç»†å®¡æŸ¥æŠ¥å‘Š]

> @code_review æ€»ç»“ä¸‹ä¸Šè¿°çš„ä»£ç å®¡æŸ¥æŠ¥å‘Š
Agent: æ ¹æ®åˆšæ‰çš„åˆ†æï¼Œä¸»è¦é—®é¢˜åŒ…æ‹¬...

> ç”¨ code_review agent ç»™å‡ºå…·ä½“ä¿®æ”¹å»ºè®®
Agent: å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå»ºè®®...
```

### 4. æ¸…é™¤å¯¹è¯

```bash
/agents clear code_review
```

---

## ğŸ“Š åŠŸèƒ½çŠ¶æ€

### âœ… å·²å®ç°åŠŸèƒ½

#### Agent ç®¡ç†
- âœ… `/agents list` - åˆ—å‡ºæ‰€æœ‰ agents
- âœ… `/agents create` - åˆ›å»ºæ–° agent
- âœ… `/agents info` - æŸ¥çœ‹ agent è¯¦æƒ…
- âœ… `/agents validate` - éªŒè¯ agent é…ç½®
- âœ… `/agents delete` - åˆ é™¤ agent

#### Agent æ‰§è¡Œ
- âœ… `/agents run <name> <prompt>` - æ‰§è¡Œ agent
- âœ… `/agents clear <name>` - æ¸…é™¤å¯¹è¯å†å²
- âœ… å®Œæ•´å·¥å…·è°ƒç”¨å¾ªç¯
- âœ… å·¥å…·æ‰§è¡Œå¯è§†åŒ–
- âœ… Token ä½¿ç”¨ç»Ÿè®¡

#### è‡ªç„¶è¯­è¨€è°ƒç”¨
- âœ… "ä½¿ç”¨ <agent> agent ..." æ¨¡å¼
- âœ… "ç”¨ <agent> agent ..." æ¨¡å¼
- âœ… "@<agent> ..." æ¨¡å¼
- âœ… "è®© <agent> agent ..." æ¨¡å¼

#### ä¸Šä¸‹æ–‡ç®¡ç†
- âœ… ä¼šè¯çº§ä¸Šä¸‹æ–‡æŒä¹…åŒ–
- âœ… è¿ç»­å¯¹è¯æ”¯æŒ
- âœ… ç‹¬ç«‹çš„ agent å¯¹è¯å†å²

#### å·¥å…·æ§åˆ¶
- âœ… å·¥å…·ç™½åå• (allow)
- âœ… å·¥å…·é»‘åå• (deny)
- âœ… è¿è¡Œæ—¶å·¥å…·è¿‡æ»¤

### ğŸš§ å¾…å®ç°åŠŸèƒ½ (P2)

- ğŸ”„ Agent åä½œå’Œä»»åŠ¡ç§»äº¤
- ğŸ¯ è‡ªåŠ¨ agent è·¯ç”±
- ğŸ›¡ï¸ è¾“å‡ºæ ¡éªŒ (Guardrails)
- ğŸ’¾ è·¨ä¼šè¯ä¸Šä¸‹æ–‡æŒä¹…åŒ–
- ğŸ“Š æ‰§è¡Œæµç¨‹å¯è§†åŒ–
- ğŸ”Œ MCP å·¥å…·å®é™…è°ƒç”¨

---

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CLI Commands                    â”‚
â”‚  /agents create, list, run, clear, ...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AgentExecutor (Singleton)          â”‚
â”‚  â€¢ æ‰§è¡Œ agents                          â”‚
â”‚  â€¢ å·¥å…·è°ƒç”¨å¾ªç¯                          â”‚
â”‚  â€¢ ä¸Šä¸‹æ–‡ç®¡ç†                            â”‚
â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚         â”‚         â”‚         â”‚
  â†“         â†“         â†“         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Agent  â”‚â”‚Context â”‚â”‚  Tool  â”‚â”‚  MCP   â”‚
â”‚Manager â”‚â”‚Manager â”‚â”‚ Filter â”‚â”‚Registryâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»„ä»¶**:
- **AgentExecutor**: å…¨å±€å•ä¾‹ï¼Œç®¡ç†æ‰€æœ‰ agent æ‰§è¡Œ
- **AgentManager**: Agent å®šä¹‰åŠ è½½å’Œç®¡ç†
- **ContextManager**: ç‹¬ç«‹çš„å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
- **ToolFilter**: åŸºäº allow/deny çš„å·¥å…·è¿‡æ»¤
- **MCPRegistry**: MCP æœåŠ¡å™¨é…ç½®ç®¡ç†

---

## ğŸ“ æ–‡ä»¶ä½ç½®

### æ ¸å¿ƒå®ç°
```
packages/core/src/agents/
â”œâ”€â”€ AgentExecutor.ts         # æ‰§è¡Œå™¨
â”œâ”€â”€ AgentManager.ts          # Agent ç®¡ç†
â”œâ”€â”€ ContextManager.ts        # ä¸Šä¸‹æ–‡ç®¡ç†
â”œâ”€â”€ ToolFilter.ts            # å·¥å…·è¿‡æ»¤
â”œâ”€â”€ MCPRegistry.ts           # MCP æ³¨å†Œ
â”œâ”€â”€ AgentValidator.ts        # éªŒè¯å™¨
â”œâ”€â”€ AgentParser.ts           # Markdown è§£æ
â””â”€â”€ types.ts                 # ç±»å‹å®šä¹‰
```

### CLI å‘½ä»¤
```
packages/cli/src/ui/
â”œâ”€â”€ commands/
â”‚   â””â”€â”€ agentsCommand.ts     # æ‰€æœ‰ agent å‘½ä»¤
â””â”€â”€ hooks/
    â”œâ”€â”€ agentCommandProcessor.ts  # è‡ªç„¶è¯­è¨€è¯†åˆ«
    â””â”€â”€ useGeminiStream.ts        # è¾“å…¥å¤„ç†é›†æˆ
```

### Agent å®šä¹‰
```
.gemini/agents/              # é¡¹ç›®çº§ agents
~/.gemini/agents/            # å…¨å±€çº§ agents
```

---

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œ agent ç›¸å…³æµ‹è¯•
npm test -- agents
```

---

## ğŸ“– ç›¸å…³èµ„æº

- **ä¸»æ–‡æ¡£**: [README.md](../../README.md)
- **è´¡çŒ®æŒ‡å—**: [CONTRIBUTING.md](../../CONTRIBUTING.md)
- **æ¶æ„æ–‡æ¡£**: [architecture.md](../../architecture.md)

---

**é¡¹ç›®çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å®Œæˆ
**ç‰ˆæœ¬**: v1.0 (P1 å®Œæˆ)
**æœ€åæ›´æ–°**: 2025-10-06
